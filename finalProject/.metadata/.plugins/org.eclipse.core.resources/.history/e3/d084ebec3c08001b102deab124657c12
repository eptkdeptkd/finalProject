<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@taglib  prefix="spring" uri="http://www.springframework.org/tags" %>    
<style type="text/css">
.wrap{
	top:100px;
	left:0px;
	position:absolute;
	width:300px;
	height:350px;
}
.target{
	position:relative;
	width:300px;
	height:350px;
	margin: 0 auto;
}
.photo{
	position:absolute;
	top:0;
	left:0;
	width:100%;
	height:100%;
	background-repeat: no-repeat;
	background-position:center;
	background-size:cover;
	transition:transform .5s ease-out;
}
</style>


<div style="float:left;" class="wrap">
	<div class="target"></div>
</div>


<h3 style="clear:both; margin-top:500px;">${dto.name }</h3>  
<h6>${dto.price }</h6>
<input type="button" id="minusbtn" value="-"> &nbsp;&nbsp;
<input type="text" id="qtyText" value="1"> &nbsp;&nbsp;
<input type="button" id="plusbtn" value="+"> 
<br>

<input type="button" onclick="order(${dto.seq})" value="장바구니 추가">

<br><br>
<hr>
<div>
${dto.info }
</div>


<script type="text/javascript">
let qty = 1;
$("#minusbtn").click(function(){
	if(qty-1 > 0){
		qty = qty-1;
		$("#qtyText").val(qty);
	}
});

$("#plusbtn").click(function(){
	qty = qty + 1;
	$("#qtyText").val(qty);
});

function order(seq){
	var price = ${dto.price} * qty;

	$.ajax({
		url:"cart.do",
		//data:{"id":${login.id}, "coffee_seq":seq, "price":price },
		data:{"id":"OJEA", "coffee_seq":seq, "price":price },
		type:"post",
		success:function(b){
			alert(b);
			if(b) {
				alert("정상적으로 카트에 담겼습니다");
			}
			else alert("장바구니 추가 중 오류가 발생하였습니다");
		},
		error:function(){
			alert("error");
		}
	});
}

$(document).ready(function(){
	var imgsrc = "http://192.168.0.195:8090/finalProject/upload/${dto.newname }";
	$(".target").css("background-image","url("+imgsrc+")");
});

$(".target").mouseover(function(){
	$(this).children('.photo').css('transform','scale(2)');
});

$(".target").mouseout(function(){
	$(this).children('.photo').css('transform','scale(1)');
});

$(".target").mousemove(function(e){
	$(this).children('.photo').css({
		'transform-origin': ((e.pageX - $(this).offset().left) / 100) * 100 + '% ' + ((e.pageY - $(this).offset().top) / 100) * 100 + '%'
	});
});

/*
$("#cfimg").mousemove(function(e){
	var x = (e.clientX-10)+20;
	var y = (e.clientY-10)+20;

	var imgsrc = "http://192.168.0.195:8090/finalProject/upload/${dto.newname }";

	
	$("#showimg").css("background-image","url("+imgsrc+")");
	$("#showimg").css("backgroundPosition", x+"px "+y+"px");
	
});

$("#cfimg").mouseout(function(){
	$("#showimg").css("background-image","");
});
*/

</script>